<!DOCTYPE html>
<html>
<head>
    <title>テストアプリ</title>
    <script>
        let intervalId = null; // 自動更新のIDを保持する変数
        
        const updateLux = async(url, element) => {
            const sensorData = await fetch(url)
                .then(response => response.text())
            const target = document.getElementById(element)
            const luxValue = parseInt(sensorData.split(',')[1]) // 照度値を取得
            target.innerHTML = `<h1>${sensorData}</h1>`
            if (luxValue > 0) {
                target.innerHTML += "<p>サイド判定です</p>" // サイド判定を追加
                clearInterval(intervalId); // サイド判定時に自動更新を停止
            }
        }
        
        // 自動更新用の関数
        const autoUpdateLux = (url, element) => {
            intervalId = setInterval(() => { // 一定間隔ごとに更新する
                updateLux(url, element)
            }, 1000) // 1000ミリ秒ごとに更新
        }
        
        // ページ読み込み時に自動更新を開始
        window.onload = () => {
            autoUpdateLux('/lux', 'data')
        }
    </script>
</head>
<body>
    <center>
        <div id="data">test</div>
        <!-- ボタンは不要なので削除 -->
    </center>
</body>
</html>






<!-- <!DOCTYPE html>
<html>
    <head>
        <title>テストアプリ</title>
        <script>
            const updateLux = async(url, element) => {
                const sensorData = await fetch(url)
                .then(response => response.text())
                const target = document.getElementById(element)
                target.innerHTML = `<h1>${sensorData}</h1>`
            }
        </script>
    </head>
    <body onload="updateLux('/lux','data')">
        <center>
            <div id = "data">test</div>
            <input type="button" value="更新" onclick="updateLux('/lux','data')">
        </center>
    </body>
</html> -->